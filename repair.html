<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans'>
    <link rel="stylesheet" href="assets/css/style.css">
    <title>Repair</title>
</head>

<body>
<div class="sales">
    <div class="sales-header">
        <div class="title">Repair</div>
        <div class="search">
            <!-- <input type="text"/> -->
        </div>
        <div class="end"></div>
    </div>
    <div class="sale-container">
        <div class="sales-left">
            <div class="item-container">
                <table>
                    <thead>
                        <th>TYPE</th>
                        <th>DESCRIPTION</th>
                        <th>AMOUNT</th>
                        <th>TOTAL</th>
                    </thead>
                    <tbody>
                        <tr>
                            <td>0111</td>
                            <td>SFfsd</td>
                            <td>5</td>
                            <td>12500</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="bottom">
                <div class="left">
                    <div class="sale-btns"> <i class="material-icons">print</i></div>
                    <div class="sale-btns"> <i class="material-icons">search</i></div>
                    <div class="sale-btns"> <i class="material-icons">settings_backup_restore</i></div>
                </div>
                <div class="right">
                    <div class="halfline">
                        <div class="top-left">ITEMS</div>
                        <div class="top-right">10</div>
                        <div class="top-left">SUBTOTAL</div>
                        <div class="top-right">Rs. 1500</div>
                    </div>
                    <div class="halfline">
                        <div class="top-left">DISCOUNTS</div>
                        <div class="top-right">Rs. 0</div>
                        <div class="top-left">PAYMENTS</div>
                        <div class="top-right">Rs. 0</div>
                    </div>
                    <div class="halfline">
                        <div class="top-left"></div>
                        <div class="top-right"></div>
                        <div class="top-left">BALANCE</div>
                        <div class="top-right">Rs. 0</div>
                    </div>
                    <div class="fullline">
                        <div class="bottom-left label">AMOUNT DUE</div>
                        <div class="bottom-right total">Rs. 0</div>
                    </div>
                </div>
            </div>
        </div>
        <div class="sales-mid">
            <input type="text" class="sales-input" placeholder="Item Code"/>
            <input type="text" class="sales-input" placeholder="Quantity"/>
            <table class="cal">
                <tr>
                    <td><button>7</button></td>
                    <td><button>8</button></td>
                    <td><button>9</button></td>
                    <td><button><i class="material-icons">backspace</i></button></td>
                </tr>
                <tr>
                    <td><button>4</button></td>
                    <td><button>5</button></td>
                    <td><button>6</button></td>
                    <td><button>+</button></td>
                </tr>
                <tr>
                    <td><button>1</button></td>
                    <td><button>2</button></td>
                    <td><button>3</button></td>
                    <td><button>-</button></td>
                </tr>
                <tr>
                    <td><button>0</button></td>
                    <td><button>.</button></td>
                    <td><button>=</button></td>
                    <td><button class="return"><i class="material-icons">keyboard_return</i></button></td>
                </tr>
            </table>
        </div>
        <div class="sales-right">
            <div class="icon-container">
                <div class="item" onclick="navigate(0)">
                    <div class="empty">
                        <i class="material-icons">widgets</i>
                        STOCK
                    </div>
                </div>
                <div class="item" onclick="navigate(1)">
                    <div class="empty">
                        <i class="material-icons">point_of_sale</i>
                        SALES
                    </div>
                </div>
                <div class="item" onclick="navigate(2)">
                    <div class="selected">
                        <i class="material-icons">construction</i>
                        REPAIR
                    </div>
                    <div class="indicate"></div>
                </div>
                <div class="item" onclick="navigate(3)">
                    <div class="empty">
                        <i class="material-icons">attach_money</i>
                        EXPENSES
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
<script>
    var mysql = require('mysql');

    function el(selector) {
        return document.getElementById(selector);
    }

    el('action-btn').addEventListener('click', function () {
        // Get the mysql service
        getFirstTenRows(function (rows) {
            var html = '';

            rows.forEach(function (row) {
                html += '<tr>';
                html += '<td>';
                html += row.id;
                html += '</td>';
                html += '<td>';
                html += row.display_name;
                html += '</td>';
                html += '<td>';
                html += row.city;
                html += '</td>';
                html += '</tr>';
                console.log(row);
            });

            document.querySelector('#table > tbody').innerHTML = html;
            document.querySelector('#table > thead').innerHTML = '<tr><th scope="col">ID</th> <th scope="col">Name</th> <th scope="col">Location</th> </tr>';
            document.querySelector('#table > tfoot').innerHTML = '<tr><td colspan="3">Last joined 10 users are listed here.</td> </tr>';

        });
    }, false);

    function getFirstTenRows(callback) {
        var mysql = require('mysql');
        var config = require("./db-config");

        // Add the credentials to access your database
        var connection = mysql.createConnection(config.db);

        // connect to mysql
        connection.connect(function (err) {
            // in case of error
            if (err) {
                console.log(err.code);
                console.log(err.fatal);
            }
        });

        // Perform a query
        $query = 'SELECT id, display_name, city FROM user_profile ORDER BY id DESC LIMIT 8';

        connection.query($query, function (err, rows, fields) {
            if (err) {
                console.log("An error ocurred performing the query.");
                console.log(err);
                return;
            }

            callback(rows);

            console.log("Query succesfully executed");
        });

        connection.end(function () {
        });
    }

    function navigate(pos) {
        switch(pos) {
            case 0:
                window.location.href = "inventory.html"
                break;
            case 1:
                window.location.href = "sales.html"
                break;
            case 2:
                window.location.href = "repair.html";
                break;
            case 3:
                window.location.href = "expenses.html";
                break;
            default:
                break;
        }
    }
</script>
</html>
